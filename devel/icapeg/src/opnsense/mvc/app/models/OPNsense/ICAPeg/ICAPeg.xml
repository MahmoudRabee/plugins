<!-- <model>
    <mount>//OPNsense/icapeg</mount>
    <description>
        the OPNsense "ICAPeg" application
    </description>
    <items> -->
        <!-- container -->
        <!-- <general> -->
            <!-- fields -->
           <!--  <PortNum type="PortField">
                <default>1344</default>
                <ValidationMessage>Error Port value</ValidationMessage>
                <Required>Y</Required>
            </PortNum>
            <LogLevel type="TextField">
                <default>debug</default>
                <Required>Y</Required>
            </LogLevel>
            <WritingLogsToConsole type="TextField">
                <default>false</default>
                <Required>Y</Required>
            </WritingLogsToConsole>
            <DebuggingHeaders type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </DebuggingHeaders>


             <echoHeader type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </echoHeader>
            <echo_req_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </echo_req_mode>
            <echo_resp_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </echo_resp_mode>
            <echo_shadow_service type="TextField">
                <default>false</default>
                <Required>N</Required>
            </echo_shadow_service>
            <echo_preview_bytes type="NumericField">
                <default>1024</default>
                <Required>N</Required>
            </echo_preview_bytes>
            <echo_preview_enabled type="TextField">
                <default>true</default>
                <Required>N</Required>
            </echo_preview_enabled>
            <echo_max_filesize type="NumericField">
                <default>0</default>
                <Required>N</Required>
            </echo_max_filesize>
            <echo_return_original_if_max_file_size_exceeded type="TextField">
                <default>false</default>
                <Required>N</Required>
            </echo_return_original_if_max_file_size_exceeded>
            <echo_return_400_if_file_ext_rejected type="TextField">
                <default>false</default>
                <Required>N</Required>
            </echo_return_400_if_file_ext_rejected>


            <clamavHeader type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </clamavHeader>
            <clamav_req_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </clamav_req_mode>
            <clamav_resp_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </clamav_resp_mode>
            <clamav_shadow_service type="TextField">
                <default>false</default>
                <Required>N</Required>
            </clamav_shadow_service>
            <clamav_preview_bytes type="NumericField">
                <default>1024</default>
                <Required>N</Required>
            </clamav_preview_bytes>
            <clamav_preview_enabled type="TextField">
                <default>true</default>
                <Required>N</Required>
            </clamav_preview_enabled>
            <clamav_max_filesize type="NumericField">
                <default>0</default>
                <Required>N</Required>
            </clamav_max_filesize>
            <clamav_return_original_if_max_file_size_exceeded type="TextField">
                <default>false</default>
                <Required>N</Required>
            </clamav_return_original_if_max_file_size_exceeded>
            <clamav_return_400_if_file_ext_rejected type="TextField">
                <default>false</default>
                <Required>N</Required>
            </clamav_return_400_if_file_ext_rejected>




            <grayimagesHeader type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </grayimagesHeader>
            <grayimages_req_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </grayimages_req_mode>
            <grayimages_resp_mode type="TextField">
                <default>true</default>
                <Required>Y</Required>
            </grayimages_resp_mode>
            <grayimages_shadow_service type="TextField">
                <default>false</default>
                <Required>N</Required>
            </grayimages_shadow_service>
            <grayimages_preview_bytes type="NumericField">
                <default>1024</default>
                <Required>N</Required>
            </grayimages_preview_bytes>
            <grayimages_preview_enabled type="TextField">
                <default>true</default>
                <Required>N</Required>
            </grayimages_preview_enabled>
            <grayimages_max_filesize type="NumericField">
                <default>0</default>
                <Required>N</Required>
            </grayimages_max_filesize>
            <grayimages_return_original_if_max_file_size_exceeded type="TextField">
                <default>false</default>
                <Required>N</Required>
            </grayimages_return_original_if_max_file_size_exceeded>
            <grayimages_return_400_if_file_ext_rejected type="OptionField">
                <default>false</default>
                <Required>N</Required>
            </grayimages_return_400_if_file_ext_rejected> 
            

            <clamavHeader type="BooleanField">
            <default>0</default>
            <Required>Y</Required>
        </clamavHeader>
        <clamav_max_filesize type="OptionField">
            <default>TEXT,DATA,EXECUTABLE,ARCHIVE,GIF,JPEG,MSOFFICE</default>
            <multiple>Y</multiple>
            <Required>Y</Required>
                <OptionValues>
                    <TEXT>Text files</TEXT>
                    <DATA>Binary files</DATA>
                    <EXECUTABLE>Executables</EXECUTABLE>
                    <ARCHIVE>Archives</ARCHIVE>
                    <GIF>GIF animations</GIF>
                    <JPEG>JPEG pictures</JPEG>
                    <MSOFFICE>Microsoft office files</MSOFFICE>
                </OptionValues>
        </clamav_max_filesize>




         </general>
    </items>

</model> -->


<form>
    <field>
        <id>antivirus.enable_clamav</id>
        <label>Enable ClamAV</label>
        <type>checkbox</type>
        <help>This will activate ClamAV</help>
    </field>
    <field>
        <id>antivirus.scanfiletypes</id>
        <label>Scan for filetypes</label>
        <type>select_multiple</type>
        <help>Choose for which file types to scan, if unsure select all.</help>
    </field>
    <field>
        <id>antivirus.sendpercentdata</id>
        <label>Send percentage data</label>
        <type>text</type>
        <help>The percentage of data that can be sent by the c-icap server before receiving the complete body of a request. This feature in conjuction with the folowing can be useful because if the download of the object takes a lot of time the connection of web client to proxy can be expired.</help>
    </field>
    <field>
        <id>antivirus.startsendpercentdataafter</id>
        <label>Start send percentage data</label>
        <type>text</type>
        <help>Only if the object is bigger than size then the percentage of data which defined by SendPercentData sent by the c-icap server before receiving the complete body of request.</help>
    </field>
    <field>
        <id>antivirus.allow204responses</id>
        <label>Allow 204 responses</label>
        <type>checkbox</type>
        <help>Disable 204 responses outside previews for virus_scan if your ICAP client does not support it.</help>
    </field>
    <field>
        <id>antivirus.passonerror</id>
        <label>Pass on error</label>
        <type>checkbox</type>
        <help>Pass the content instead of blocking it, in the case when the virus scanner or the virus_scan module finds an error.</help>
    </field>
    <field>
        <id>antivirus.maxobjectsize</id>
        <label>Max object size</label>
        <type>text</type>
        <help>The maximum size of files which will be scanned by antivirus service. You can use K and M indicators to define size in kilobytes or megabytes.</help>
    </field>
</form>
