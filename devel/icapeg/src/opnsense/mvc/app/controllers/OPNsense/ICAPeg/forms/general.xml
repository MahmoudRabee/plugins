<!-- <form>
    <field>
        <id>icapeg.general.PortNum</id>
        <label>Port number</label>
        <type>text</type>
        <help><![CDATA[default port of ICAPeg]]></help>
        <help>1344</help>
    </field>
    <field>
        <id>icapeg.general.LogLevel </id>
        <label>LogLevel</label>
        <type>text</type>
        <help>options:debug, info, error, or fatal</help>
    </field>
    <field>
        <id>icapeg.general.WritingLogsToConsole</id>
        <label>Writing logs to console</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.DebuggingHeaders</id>
        <label>Debugging headers</label>
        <type>text</type>
        <help>
            options: true or false
            Enable this feature if you want to add debugging headers to ICAP response ex: X-ICAPeg-Shadow-Service
        </help>
    </field>


    <field>
        <id>icapeg.general.echoHeader</id>
        <label>Echo services</label>
        <type>header</type>
    </field>
    <field>
        <id>icapeg.general.echo_req_mode</id>
        <label>Enable request mode</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.echo_resp_mode</id>
        <label>Enable response mode</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.echo_shadow_service</id>
        <label>Enable shadow service</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.echo_preview_bytes</id>
        <label>Preview bytes</label>
        <type>text</type>
        <help>preview bytes </help>
    </field>
    <field>
        <id>icapeg.general.echo_preview_enabled</id>
        <label>Preview enabled</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>
    <field>
        <id>icapeg.general.echo_max_filesize</id>
        <label>Maximum file size</label>
        <type>text</type>
        <help>write 0 for unlimited file size </help>
    </field>
    <field>
        <id>icapeg.general.echo_return_original_if_max_file_size_exceeded</id>
        <label>return original if max file size exceeded</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>
    <field>
        <id>icapeg.general.echo_return_400_if_file_ext_rejected</id>
        <label>return 400 if file ext rejected</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>



    <field>
        <id>icapeg.general.clamavHeader</id>
        <label>Clamav services</label>
        <type>header</type>
    </field>
    <field>
        <id>icapeg.general.clamav_req_mode</id>
        <label>Enable request mode</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.clamav_resp_mode</id>
        <label>Enable response mode</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.clamav_shadow_service</id>
        <label>Enable shadow service</label>
        <type>text</type>
        <help>options: true or false</help>
    </field>
    <field>
        <id>icapeg.general.clamav_preview_bytes</id>
        <label>Preview bytes</label>
        <type>text</type>
        <help>preview bytes </help>
    </field>
    <field>
        <id>icapeg.general.clamav_preview_enabled</id>
        <label>Preview enabled</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>
    <field>
        <id>icapeg.general.clamav_max_filesize</id>
        <label>Maximum file size</label>
        <type>text</type>
        <help>write 0 for unlimited file size </help>
    </field>
    <field>
        <id>icapeg.general.clamav_return_original_if_max_file_size_exceeded</id>
        <label>return original if max file size exceeded</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>
    <field>
        <id>icapeg.general.clamav_return_400_if_file_ext_rejected</id>
        <label>return 400 if file ext rejected</label>
        <type>text</type>
        <help>options: true or false </help>
    </field>





        <field>
                <id>icapeg.general.grayimagesHeader</id>
                <label>GrayImages services</label>
                <type>header</type>
                </field>
                <field>
                <id>icapeg.general.grayimages_req_mode</id>
                <label>Enable request mode</label>
                <type>text</type>
                <help>options: true or false</help>
            </field>
            <field>
                <id>icapeg.general.grayimages_resp_mode</id>
                <label>Enable response mode</label>
                <type>text</type>
                <help>options: true or false</help>
            </field>
            <field>
                <id>icapeg.general.grayimages_shadow_service</id>
                <label>Enable shadow service</label>
                <type>text</type>
                <help>options: true or false</help>
            </field>
            <field>
                <id>icapeg.general.grayimages_preview_bytes</id>
                <label>Preview bytes</label>
                <type>text</type>
                <help>preview bytes </help>
            </field>
            <field>
                <id>icapeg.general.grayimages_preview_enabled</id>
                <label>Preview enabled</label>
                <type>text</type>
                <help>options: true or false </help>
            </field>
            <field>
                <id>icapeg.general.grayimages_max_filesize</id>
                <label>Maximum file size</label>
                <type>text</type>
                <help>write 0 for unlimited file size </help>
            </field>
            <field>
                <id>icapeg.general.grayimages_return_original_if_max_file_size_exceeded</id>
                <label>return original if max file size exceeded</label>
                <type>text</type>
                <help>options: true or false </help>
            </field>
            <field>
                <id>icapeg.general.grayimages_return_400_if_file_ext_rejected</id>
                <label>return 400 if file ext rejected</label>
                <type>text</type>
                <help>options: true or false </help>
            </field>
             <field>
                <id>icapeg.general.grayimages_return_400_if_file_ext_rejected</id>
                <label>return 400 if file ext rejected</label>
                <type>dropdown</type>
                <help>options: true or false </help>



                
                
            </field>
           

        </form>

 -->
 <model>
    <mount>//OPNsense/cicap/general</mount>
    <description>c-icap configuration</description>
    <version>1.0.1</version>
    <items>
        <enabled type="BooleanField">
            <default>0</default>
            <Required>Y</Required>
        </enabled>
        <timeout type="IntegerField">
            <default>300</default>
            <Required>Y</Required>
        </timeout>
        <maxkeepaliverequests type="IntegerField">
            <default>100</default>
            <Required>Y</Required>
        </maxkeepaliverequests>
        <keepalivetimeout type="IntegerField">
            <default>600</default>
            <Required>Y</Required>
        </keepalivetimeout>
        <startservers type="IntegerField">
            <default>3</default>
            <Required>Y</Required>
        </startservers>
        <maxservers type="IntegerField">
            <default>10</default>
            <Required>Y</Required>
        </maxservers>
        <minsparethreads type="IntegerField">
            <default>10</default>
            <Required>Y</Required>
        </minsparethreads>
        <maxsparethreads type="IntegerField">
            <default>20</default>
	    <Required>Y</Required>
	</maxsparethreads>
        <threadsperchild type="IntegerField">
            <default>10</default>
	    <Required>Y</Required>
	</threadsperchild>
        <maxrequestsperchild type="IntegerField">
            <default>0</default>
	    <Required>Y</Required>
	</maxrequestsperchild>
        <listenaddress type="NetworkField">
            <default>::1</default>
	    <WildcardEnabled>N</WildcardEnabled>
	    <NetMaskRequired>N</NetMaskRequired>
	    <FieldSeparator>,</FieldSeparator>
            <Required>Y</Required>
        </listenaddress>
        <serveradmin type="TextField">
            <default></default>
            <Required>N</Required>
        </serveradmin>
        <servername type="TextField">
            <default></default>
            <Required>N</Required>
        </servername>
        <enable_accesslog type="BooleanField">
            <default>1</default>
            <Required>Y</Required>
        </enable_accesslog>
        <localSquid type="BooleanField">
            <default>1</default>
            <Required>Y</Required>
        </localSquid>
    </items>
</model>